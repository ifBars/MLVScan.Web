export default function ScheduleIMoreNpcsMalwareAnalysisContent() {
  return (
    <>
      <div className="bg-red-500/10 border-2 border-red-500/50 rounded-lg p-6 mb-6">
        <p className="text-xl font-bold text-red-200 mb-3">⚠️ IMPORTANT DISCLAIMER</p>
        <p className="text-gray-200 mb-4">
          This advisory analyzes a malicious <strong>reupload</strong> of a legitimate mod. The original <strong>ScheduleIMoreNpcs</strong> mod and its author are legitimate and safe.
        </p>
        <p className="text-gray-200">
          A malicious actor downloaded/stole the original mod, injected malware into it, and reuploaded it to Nexus Mods under the same or similar name. If you are using the authentic original version from the legitimate author, you are safe. <strong>Only this specific malicious reupload is dangerous.</strong>
        </p>
      </div>

      <p className="text-lg text-gray-300 mb-6">
        On November 21, 2025, this malicious reupload was uploaded to Nexus Mods, disguised as a utility to add more NPCs to the game. The mod uses sophisticated obfuscation techniques including encoded string decoding, reflection-based instantiation, and environment path access to hide its malicious behavior. The mod was detected and removed shortly after upload.
      </p>

      <hr className="border-gray-800 my-8" />

      <h2 id="malicious-behavior" className="text-2xl font-bold text-white mb-4">Malicious Behavior</h2>
      
      <p className="text-gray-300 mb-4">
        The mod employs multiple evasion and obfuscation techniques to hide its true purpose:
      </p>

      <h3 className="text-lg font-semibold text-white mb-3">1. String Obfuscation</h3>
      <p className="text-gray-300 mb-4">
        The malware encodes strings as ASCII numbers and decodes them at runtime to avoid detection:
      </p>
      <pre className="bg-gray-950 border border-gray-800 rounded-lg p-4 overflow-x-auto mb-6">
        <code className="text-sm text-gray-300">
{`// Encoded string pattern - hides actual strings from static analysis
string[] parts = connect.Split('\x60');
char[] decoded = parts.Select(p => (char)int.Parse(p)).ToArray();
string result = string.Concat(decoded); // Decoded at runtime`}
        </code>
      </pre>

      <h3 className="text-lg font-semibold text-white mb-3">2. Reflection-Based Instantiation</h3>
      <p className="text-gray-300 mb-4">
        Uses <code>Activator.CreateInstance</code> to dynamically create objects, bypassing static analysis:
      </p>
      <pre className="bg-gray-950 border border-gray-800 rounded-lg p-4 overflow-x-auto mb-6">
        <code className="text-sm text-gray-300">
{`// Dynamic object creation - target type not visible in IL
object instance = Activator.CreateInstance(targetType);
Initialize.PutData(instance, targetType, key, value);`}
        </code>
      </pre>

      <h3 className="text-lg font-semibold text-white mb-3">3. Environment Path Access</h3>
      <p className="text-gray-300 mb-4">
        Accesses sensitive system directories using <code>Environment.GetFolderPath</code>:
      </p>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li>SpecialFolder 26 (likely ApplicationData or LocalApplicationData)</li>
        <li>Accesses user profile and application directories</li>
        <li>Potential persistence via startup folders or registry</li>
      </ul>

      <h3 className="text-lg font-semibold text-white mb-3">4. Exception Handling</h3>
      <p className="text-gray-300 mb-6">
        All malicious methods are wrapped in try-catch blocks with generic catch handlers (<code>catch (object)</code>) to silently suppress any errors and prevent detection through crash logs.
      </p>

      <hr className="border-gray-800 my-8" />

      <h2 id="detection" className="text-2xl font-bold text-white mb-4">MLVScan Detection</h2>
      
      <p className="text-gray-300 mb-4">
        MLVScan detected this threat through multiple detection vectors:
      </p>

      <pre className="bg-gray-950 border border-gray-800 rounded-lg p-4 overflow-x-auto mb-6">
        <code className="text-sm text-gray-300">
{`[High] Detected encoded string to char decoding pipeline 
       (ASCII number parsing pattern)
  Rule: EncodedStringPipelineRule
  
[High] Detected reflection invocation without determinable target method 
       (potential bypass)
  Rule: SuspiciousReflectionRule
  
[Low] Detected Environment.GetFolderPath access to sensitive directories 
       (AppData, Startup, etc.)
  Rule: EnvironmentPathRule`}
        </code>
      </pre>

      <h3 className="text-lg font-semibold text-white mb-3">Detection Challenges</h3>
      <p className="text-gray-300 mb-6">
        This malware is particularly dangerous because it uses <strong>encoding obfuscation</strong>. The actual malicious strings (URLs, file paths, command names) are not present in the binary as readable text. Instead, they're stored as numbers and decoded at runtime, making signature-based detection difficult.
      </p>

      <h3 className="text-lg font-semibold text-white mb-3">Community Response</h3>
      <p className="text-gray-300 mb-4">
        The Schedule 1 modding Discord community actively monitors the Schedule 1 category on Nexus Mods. When this malware was detected, community members immediately analyzed and reported it, leading to its removal. Beyond reporting to Nexus Mods, the community also reports malicious domains to registrars and hosting providers to further deter attackers. While scan rules are updated when applicable, most malware mods use simple patterns that MLVScan already blocks effectively.
      </p>

      <hr className="border-gray-800 my-8" />

      <h2 id="recommendations" className="text-2xl font-bold text-white mb-4">Recommendations</h2>
      
      <h3 className="text-xl font-semibold text-white mb-2">For Users Who Downloaded This Mod</h3>
      <div className="bg-orange-500/10 border border-orange-500/30 rounded-lg p-4 mb-6">
        <p className="text-orange-200 font-medium mb-2">⚠️ If you installed this mod:</p>
        <ul className="list-disc pl-6 space-y-1 text-gray-300">
          <li><strong>Immediately uninstall</strong> and delete all mod files</li>
          <li><strong>Run a full antivirus scan</strong> on your system</li>
          <li><strong>Check %APPDATA% and %LOCALAPPDATA%</strong> for suspicious files</li>
          <li><strong>Check browser data</strong> - this mod may have accessed browser directories</li>
          <li><strong>Change all passwords</strong> (Steam, banking, email, game accounts)</li>
          <li><strong>Review registry run keys</strong> for unexpected startup entries</li>
          <li><strong>Consider wiping and reinstalling Windows</strong></li>
        </ul>
      </div>

      <h3 className="text-xl font-semibold text-white mb-2">For All Users</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Always scan mods</strong> with MLVScan before installation</li>
        <li><strong>Be wary of reflection-heavy code</strong> - legitimate mods rarely use Activator.CreateInstance</li>
        <li><strong>Check for obfuscation</strong> - encoded strings are a red flag</li>
        <li><strong>Verify mod popularity</strong> - this was a new upload with few downloads</li>
        <li><strong>Report suspicious mods</strong> immediately to Nexus Mods</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="technical-analysis" className="text-2xl font-bold text-white mb-4">Technical Analysis</h2>
      
      <h3 className="text-lg font-semibold text-white mb-3">Indicators of Compromise (IOCs)</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>Mod Name:</strong> ScheduleIMoreNpcs / MelonLoaderMod17</li>
        <li><strong>File Name:</strong> ScheduleIMoreNpcs.dll</li>
        <li><strong>Assembly Name:</strong> MelonLoaderMod17, Version=1.1.4.0</li>
        <li><strong>Obfuscation Method:</strong> ASCII number encoding with backtick delimiter (`)</li>
        <li><strong>Reflection Targets:</strong> Unknown (types passed as parameters)</li>
        <li><strong>Environment Access:</strong> SpecialFolder 26 (ApplicationData)</li>
        <li><strong>Key Methods:</strong> UnityWriter, UnityCoreEngine, CallQuiet, PutData</li>
      </ul>

      <h3 className="text-lg font-semibold text-white mb-3">Evasion Techniques</h3>
      <ul className="list-disc pl-6 space-y-2 text-gray-300 mb-6">
        <li><strong>String Encoding:</strong> ASCII number representation hides strings</li>
        <li><strong>Reflection:</strong> Activator.CreateInstance hides object types</li>
        <li><strong>Exception Suppression:</strong> Generic catch blocks hide errors</li>
        <li><strong>Indirect Calls:</strong> PutData and CallQuiet methods for hidden execution</li>
        <li><strong>Legitimate Appearance:</strong> Mod name suggests harmless NPC utility</li>
      </ul>

      <hr className="border-gray-800 my-8" />

      <h2 id="references" className="text-2xl font-bold text-white mb-4">References</h2>
      <ul className="list-disc pl-6 space-y-2 text-gray-300">
        <li>Nexus Mods Report: Mod removed, user banned</li>
        <li>Analysis Tool: MLVScan with IL inspection and encoded string detection</li>
        <li>Detection Rules: EncodedStringPipelineRule, SuspiciousReflectionRule</li>
        <li>Sample Hash: [Available upon request to security researchers]</li>
      </ul>
    </>
  )
}
